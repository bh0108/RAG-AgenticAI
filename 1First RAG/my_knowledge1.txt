# Company policy module

from dataclasses import dataclass
from datetime import date

@dataclass(frozen=True)
class WFHPolicy:
    # Python datetime.weekday(): Monday=0 ... Sunday=6
    office_days: tuple = (1, 2, 3)        # Tuesday, Wednesday, Thursday
    optional_remote_days: tuple = (0, 4)  # Monday, Friday

    def is_office_required(self, day: date) -> bool:
        """Return True if the given date requires being in the office."""
        return day.weekday() in self.office_days

    def is_optional_remote(self, day: date) -> bool:
        """Return True if the given date is an optional remote day."""
        return day.weekday() in self.optional_remote_days

@dataclass(frozen=True)
class PTOPolicy:
    annual_days: float = 20.0

    @property
    def monthly_accrual(self) -> float:
        return self.annual_days / 12.0

    def accrued_for_months(self, months: int) -> float:
        """Return PTO accrued for a whole number of months employed."""
        if months <= 0:
            return 0.0
        return months * self.monthly_accrual

    def accrued_since(self, start: date, as_of: date) -> float:
        """Compute full months between start (inclusive) and as_of (inclusive) and return accrued PTO."""
        if as_of < start:
            return 0.0
        years_diff = as_of.year - start.year
        months_diff = years_diff * 12 + (as_of.month - start.month)
        # count an additional month if as_of.day >= start.day (treat as full month)
        full_months = months_diff + (1 if as_of.day >= start.day else 0)
        if full_months < 0:
            full_months = 0
        return self.accrued_for_months(full_months)

@dataclass(frozen=True)
class TechStack:
    backend: str = "Python"
    frontend: str = "React"
    mobile: str = "React Native"

@dataclass(frozen=True)
class CompanyPolicy:
    wfh: WFHPolicy = WFHPolicy()
    pto: PTOPolicy = PTOPolicy()
    tech: TechStack = TechStack()

# Single shared policy instance
policy = CompanyPolicy()